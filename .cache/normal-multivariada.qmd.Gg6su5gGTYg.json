{
    "cells": [
        {
            "id": "1",
            "cell_type": "markdown",
            "metadata": {
            },
            "source": [
            ]
        },
        {
            "id": "2",
            "cell_type": "code",
            "metadata": {
            },
            "source": [
                "#|output: false\n",
                "using Pkg; Pkg.add([\"Distributions\", \"StatsBase\", \"Plots\", \"LaTeXStrings\", \"LinearAlgebra\", \"Random\", \"DataFrames\"])"
            ],
            "outputs": [
                {
                    "output_type": "stream",
                    "name": "stdout",
                    "text": "\u001b[32m\u001b[1m   Resolving\u001b[22m\u001b[39m package versions...\n\u001b[32m\u001b[1m    Updating\u001b[22m\u001b[39m `/tmp/jl_coZ5vy/QuartoSandbox/Project.toml`\n  \u001b[90m[a93c6f00] \u001b[39m\u001b[92m+ DataFrames v1.7.0\u001b[39m\n  \u001b[90m[31c24e10] \u001b[39m\u001b[92m+ Distributions v0.25.120\u001b[39m\n  \u001b[90m[b964fa9f] \u001b[39m\u001b[92m+ LaTeXStrings v1.4.0\u001b[39m\n  \u001b[90m[91a5bcdd] \u001b[39m\u001b[92m+ Plots v1.40.13\u001b[39m\n  \u001b[90m[2913bbd2] \u001b[39m\u001b[92m+ StatsBase v0.34.5\u001b[39m\n  \u001b[90m[37e2e46d] \u001b[39m\u001b[92m+ LinearAlgebra v1.11.0\u001b[39m\n  \u001b[90m[9a3f8284] \u001b[39m\u001b[92m+ Random v1.11.0\u001b[39m\n\u001b[32m\u001b[1m    Updating\u001b[22m\u001b[39m `/tmp/jl_coZ5vy/QuartoSandbox/Manifest.toml`\n  \u001b[90m[66dad0bd] \u001b[39m\u001b[92m+ AliasTables v1.1.3\u001b[39m\n  \u001b[90m[d1d4a3ce] \u001b[39m\u001b[92m+ BitFlags v0.1.9\u001b[39m\n  \u001b[90m[944b1d66] \u001b[39m\u001b[92m+ CodecZlib v0.7.8\u001b[39m\n  \u001b[90m[35d6a980] \u001b[39m\u001b[92m+ ColorSchemes v3.29.0\u001b[39m\n  \u001b[90m[3da002f7] \u001b[39m\u001b[92m+ ColorTypes v0.12.1\u001b[39m\n  \u001b[90m[c3611d14] \u001b[39m\u001b[92m+ ColorVectorSpace v0.11.0\u001b[39m\n  \u001b[90m[5ae59095] \u001b[39m\u001b[92m+ Colors v0.13.0\u001b[39m\n  \u001b[90m[34da2185] \u001b[39m\u001b[92m+ Compat v4.16.0\u001b[39m\n  \u001b[90m[f0e56b4a] \u001b[39m\u001b[92m+ ConcurrentUtilities v2.5.0\u001b[39m\n  \u001b[90m[d38c429a] \u001b[39m\u001b[92m+ Contour v0.6.3\u001b[39m\n  \u001b[90m[a8cc5b0e] \u001b[39m\u001b[92m+ Crayons v4.1.1\u001b[39m\n  \u001b[90m[9a962f9c] \u001b[39m\u001b[92m+ DataAPI v1.16.0\u001b[39m\n  \u001b[90m[a93c6f00] \u001b[39m\u001b[92m+ DataFrames v1.7.0\u001b[39m\n  \u001b[90m[864edb3b] \u001b[39m\u001b[92m+ DataStructures v0.18.22\u001b[39m\n  \u001b[90m[e2d170a0] \u001b[39m\u001b[92m+ DataValueInterfaces v1.0.0\u001b[39m\n  \u001b[90m[8bb1440f] \u001b[39m\u001b[92m+ DelimitedFiles v1.9.1\u001b[39m\n  \u001b[90m[31c24e10] \u001b[39m\u001b[92m+ Distributions v0.25.120\u001b[39m\n  \u001b[90m[ffbed154] \u001b[39m\u001b[92m+ DocStringExtensions v0.9.4\u001b[39m\n  \u001b[90m[460bff9d] \u001b[39m\u001b[92m+ ExceptionUnwrapping v0.1.11\u001b[39m\n  \u001b[90m[c87230d0] \u001b[39m\u001b[92m+ FFMPEG v0.4.2\u001b[39m\n  \u001b[90m[1a297f60] \u001b[39m\u001b[92m+ FillArrays v1.13.0\u001b[39m\n  \u001b[90m[53c48c17] \u001b[39m\u001b[92m+ FixedPointNumbers v0.8.5\u001b[39m\n  \u001b[90m[1fa38f19] \u001b[39m\u001b[92m+ Format v1.3.7\u001b[39m\n  \u001b[90m[28b8d3ca] \u001b[39m\u001b[92m+ GR v0.73.14\u001b[39m\n  \u001b[90m[42e2da0e] \u001b[39m\u001b[92m+ Grisu v1.0.2\u001b[39m\n  \u001b[90m[cd3eb016] \u001b[39m\u001b[92m+ HTTP v1.10.16\u001b[39m\n  \u001b[90m[34004b35] \u001b[39m\u001b[92m+ HypergeometricFunctions v0.3.28\u001b[39m\n  \u001b[90m[842dd82b] \u001b[39m\u001b[92m+ InlineStrings v1.4.3\u001b[39m\n  \u001b[90m[41ab1584] \u001b[39m\u001b[92m+ InvertedIndices v1.3.1\u001b[39m\n  \u001b[90m[92d709cd] \u001b[39m\u001b[92m+ IrrationalConstants v0.2.4\u001b[39m\n  \u001b[90m[82899510] \u001b[39m\u001b[92m+ IteratorInterfaceExtensions v1.0.0\u001b[39m\n  \u001b[90m[1019f520] \u001b[39m\u001b[92m+ JLFzf v0.1.11\u001b[39m\n  \u001b[90m[692b3bcd] \u001b[39m\u001b[92m+ JLLWrappers v1.7.0\u001b[39m\n  \u001b[90m[682c06a0] \u001b[39m\u001b[92m+ JSON v0.21.4\u001b[39m\n  \u001b[90m[b964fa9f] \u001b[39m\u001b[92m+ LaTeXStrings v1.4.0\u001b[39m\n  \u001b[90m[23fbe1c1] \u001b[39m\u001b[92m+ Latexify v0.16.7\u001b[39m\n  \u001b[90m[2ab3a3ac] \u001b[39m\u001b[92m+ LogExpFunctions v0.3.29\u001b[39m\n  \u001b[90m[e6f89c97] \u001b[39m\u001b[92m+ LoggingExtras v1.1.0\u001b[39m\n  \u001b[90m[1914dd2f] \u001b[39m\u001b[92m+ MacroTools v0.5.16\u001b[39m\n  \u001b[90m[739be429] \u001b[39m\u001b[92m+ MbedTLS v1.1.9\u001b[39m\n  \u001b[90m[442fdcdd] \u001b[39m\u001b[92m+ Measures v0.3.2\u001b[39m\n  \u001b[90m[e1d29d7a] \u001b[39m\u001b[92m+ Missings v1.2.0\u001b[39m\n  \u001b[90m[77ba4419] \u001b[39m\u001b[92m+ NaNMath v1.1.3\u001b[39m\n  \u001b[90m[4d8831e6] \u001b[39m\u001b[92m+ OpenSSL v1.4.3\u001b[39m\n  \u001b[90m[bac558e1] \u001b[39m\u001b[92m+ OrderedCollections v1.8.0\u001b[39m\n  \u001b[90m[90014a1f] \u001b[39m\u001b[92m+ PDMats v0.11.35\u001b[39m\n  \u001b[90m[69de0a69] \u001b[39m\u001b[92m+ Parsers v2.8.3\u001b[39m\n  \u001b[90m[ccf2f8ad] \u001b[39m\u001b[92m+ PlotThemes v3.3.0\u001b[39m\n  \u001b[90m[995b91a9] \u001b[39m\u001b[92m+ PlotUtils v1.4.3\u001b[39m\n  \u001b[90m[91a5bcdd] \u001b[39m\u001b[92m+ Plots v1.40.13\u001b[39m\n  \u001b[90m[2dfb63ee] \u001b[39m\u001b[92m+ PooledArrays v1.4.3\u001b[39m\n\u001b[33m⌅\u001b[39m \u001b[90m[aea7be01] \u001b[39m\u001b[92m+ PrecompileTools v1.2.1\u001b[39m\n  \u001b[90m[21216c6a] \u001b[39m\u001b[92m+ Preferences v1.4.3\u001b[39m\n  \u001b[90m[08abe8d2] \u001b[39m\u001b[92m+ PrettyTables v2.4.0\u001b[39m\n  \u001b[90m[43287f4e] \u001b[39m\u001b[92m+ PtrArrays v1.3.0\u001b[39m\n  \u001b[90m[1fd47b50] \u001b[39m\u001b[92m+ QuadGK v2.11.2\u001b[39m\n  \u001b[90m[3cdcf5f2] \u001b[39m\u001b[92m+ RecipesBase v1.3.4\u001b[39m\n  \u001b[90m[01d81517] \u001b[39m\u001b[92m+ RecipesPipeline v0.6.12\u001b[39m\n  \u001b[90m[189a3867] \u001b[39m\u001b[92m+ Reexport v1.2.2\u001b[39m\n  \u001b[90m[05181044] \u001b[39m\u001b[92m+ RelocatableFolders v1.0.1\u001b[39m\n  \u001b[90m[ae029012] \u001b[39m\u001b[92m+ Requires v1.3.1\u001b[39m\n  \u001b[90m[79098fc4] \u001b[39m\u001b[92m+ Rmath v0.8.0\u001b[39m\n  \u001b[90m[6c6a2e73] \u001b[39m\u001b[92m+ Scratch v1.2.1\u001b[39m\n  \u001b[90m[91c51154] \u001b[39m\u001b[92m+ SentinelArrays v1.4.8\u001b[39m\n  \u001b[90m[992d4aef] \u001b[39m\u001b[92m+ Showoff v1.0.3\u001b[39m\n  \u001b[90m[777ac1f9] \u001b[39m\u001b[92m+ SimpleBufferStream v1.2.0\u001b[39m\n  \u001b[90m[a2af1166] \u001b[39m\u001b[92m+ SortingAlgorithms v1.2.1\u001b[39m\n  \u001b[90m[276daf66] \u001b[39m\u001b[92m+ SpecialFunctions v2.5.1\u001b[39m\n  \u001b[90m[860ef19b] \u001b[39m\u001b[92m+ StableRNGs v1.0.3\u001b[39m\n  \u001b[90m[10745b16] \u001b[39m\u001b[92m+ Statistics v1.11.1\u001b[39m\n  \u001b[90m[82ae8749] \u001b[39m\u001b[92m+ StatsAPI v1.7.0\u001b[39m\n  \u001b[90m[2913bbd2] \u001b[39m\u001b[92m+ StatsBase v0.34.5\u001b[39m\n  \u001b[90m[4c63d2b9] \u001b[39m\u001b[92m+ StatsFuns v1.5.0\u001b[39m\n  \u001b[90m[892a3eda] \u001b[39m\u001b[92m+ StringManipulation v0.4.1\u001b[39m\n  \u001b[90m[3783bdb8] \u001b[39m\u001b[92m+ TableTraits v1.0.1\u001b[39m\n  \u001b[90m[bd369af6] \u001b[39m\u001b[92m+ Tables v1.12.0\u001b[39m\n  \u001b[90m[62fd8b95] \u001b[39m\u001b[92m+ TensorCore v0.1.1\u001b[39m\n  \u001b[90m[3bb67fe8] \u001b[39m\u001b[92m+ TranscodingStreams v0.11.3\u001b[39m\n  \u001b[90m[5c2747f8] \u001b[39m\u001b[92m+ URIs v1.5.2\u001b[39m\n  \u001b[90m[1cfade01] \u001b[39m\u001b[92m+ UnicodeFun v0.4.1\u001b[39m\n  \u001b[90m[1986cc42] \u001b[39m\u001b[92m+ Unitful v1.22.1\u001b[39m\n  \u001b[90m[45397f5d] \u001b[39m\u001b[92m+ UnitfulLatexify v1.6.4\u001b[39m\n  \u001b[90m[41fe7b60] \u001b[39m\u001b[92m+ Unzip v0.2.0\u001b[39m\n  \u001b[90m[6e34b625] \u001b[39m\u001b[92m+ Bzip2_jll v1.0.9+0\u001b[39m\n\u001b[32m⌃\u001b[39m \u001b[90m[83423d85] \u001b[39m\u001b[92m+ Cairo_jll v1.18.4+0\u001b[39m\n  \u001b[90m[ee1fde0b] \u001b[39m\u001b[92m+ Dbus_jll v1.16.2+0\u001b[39m\n  \u001b[90m[2702e6a9] \u001b[39m\u001b[92m+ EpollShim_jll v0.0.20230411+1\u001b[39m\n  \u001b[90m[2e619515] \u001b[39m\u001b[92m+ Expat_jll v2.6.5+0\u001b[39m\n\u001b[33m⌅\u001b[39m \u001b[90m[b22a6f82] \u001b[39m\u001b[92m+ FFMPEG_jll v4.4.4+1\u001b[39m\n  \u001b[90m[a3f928ae] \u001b[39m\u001b[92m+ Fontconfig_jll v2.16.0+0\u001b[39m\n  \u001b[90m[d7e528f0] \u001b[39m\u001b[92m+ FreeType2_jll v2.13.4+0\u001b[39m\n  \u001b[90m[559328eb] \u001b[39m\u001b[92m+ FriBidi_jll v1.0.17+0\u001b[39m\n  \u001b[90m[0656b61e] \u001b[39m\u001b[92m+ GLFW_jll v3.4.0+2\u001b[39m\n  \u001b[90m[d2c73de3] \u001b[39m\u001b[92m+ GR_jll v0.73.14+0\u001b[39m\n  \u001b[90m[78b55507] \u001b[39m\u001b[92m+ Gettext_jll v0.21.0+0\u001b[39m\n\u001b[32m⌃\u001b[39m \u001b[90m[7746bdde] \u001b[39m\u001b[92m+ Glib_jll v2.82.4+0\u001b[39m\n  \u001b[90m[3b182d85] \u001b[39m\u001b[92m+ Graphite2_jll v1.3.15+0\u001b[39m\n  \u001b[90m[2e76f6c2] \u001b[39m\u001b[92m+ HarfBuzz_jll v8.5.0+0\u001b[39m\n  \u001b[90m[aacddb02] \u001b[39m\u001b[92m+ JpegTurbo_jll v3.1.1+0\u001b[39m\n  \u001b[90m[c1c5ebd0] \u001b[39m\u001b[92m+ LAME_jll v3.100.2+0\u001b[39m\n  \u001b[90m[88015f11] \u001b[39m\u001b[92m+ LERC_jll v4.0.1+0\u001b[39m\n  \u001b[90m[1d63c593] \u001b[39m\u001b[92m+ LLVMOpenMP_jll v18.1.8+0\u001b[39m\n  \u001b[90m[dd4b983a] \u001b[39m\u001b[92m+ LZO_jll v2.10.3+0\u001b[39m\n\u001b[33m⌅\u001b[39m \u001b[90m[e9f186c6] \u001b[39m\u001b[92m+ Libffi_jll v3.2.2+2\u001b[39m\n  \u001b[90m[7e76a0d4] \u001b[39m\u001b[92m+ Libglvnd_jll v1.7.1+1\u001b[39m\n  \u001b[90m[94ce4f54] \u001b[39m\u001b[92m+ Libiconv_jll v1.18.0+0\u001b[39m\n  \u001b[90m[4b2f31a3] \u001b[39m\u001b[92m+ Libmount_jll v2.41.0+0\u001b[39m\n  \u001b[90m[89763e89] \u001b[39m\u001b[92m+ Libtiff_jll v4.7.1+0\u001b[39m\n  \u001b[90m[38a345b3] \u001b[39m\u001b[92m+ Libuuid_jll v2.41.0+0\u001b[39m\n  \u001b[90m[e7412a2a] \u001b[39m\u001b[92m+ Ogg_jll v1.3.5+1\u001b[39m\n  \u001b[90m[458c3c95] \u001b[39m\u001b[92m+ OpenSSL_jll v3.5.0+0\u001b[39m\n  \u001b[90m[efe28fd5] \u001b[39m\u001b[92m+ OpenSpecFun_jll v0.5.6+0\u001b[39m\n  \u001b[90m[91d4177d] \u001b[39m\u001b[92m+ Opus_jll v1.3.3+0\u001b[39m\n  \u001b[90m[36c8627f] \u001b[39m\u001b[92m+ Pango_jll v1.56.1+0\u001b[39m\n\u001b[33m⌅\u001b[39m \u001b[90m[30392449] \u001b[39m\u001b[92m+ Pixman_jll v0.44.2+0\u001b[39m\n\u001b[33m⌅\u001b[39m \u001b[90m[c0090381] \u001b[39m\u001b[92m+ Qt6Base_jll v6.7.1+1\u001b[39m\n\u001b[33m⌅\u001b[39m \u001b[90m[629bc702] \u001b[39m\u001b[92m+ Qt6Declarative_jll v6.7.1+2\u001b[39m\n\u001b[33m⌅\u001b[39m \u001b[90m[ce943373] \u001b[39m\u001b[92m+ Qt6ShaderTools_jll v6.7.1+1\u001b[39m\n\u001b[32m⌃\u001b[39m \u001b[90m[e99dba38] \u001b[39m\u001b[92m+ Qt6Wayland_jll v6.7.1+1\u001b[39m\n  \u001b[90m[f50d1b31] \u001b[39m\u001b[92m+ Rmath_jll v0.5.1+0\u001b[39m\n  \u001b[90m[a44049a8] \u001b[39m\u001b[92m+ Vulkan_Loader_jll v1.3.243+0\u001b[39m\n\u001b[32m⌃\u001b[39m \u001b[90m[a2964d1f] \u001b[39m\u001b[92m+ Wayland_jll v1.21.0+2\u001b[39m\n  \u001b[90m[2381bf8a] \u001b[39m\u001b[92m+ Wayland_protocols_jll v1.36.0+0\u001b[39m\n\u001b[33m⌅\u001b[39m \u001b[90m[02c8fc9c] \u001b[39m\u001b[92m+ XML2_jll v2.13.6+1\u001b[39m\n  \u001b[90m[ffd25f8a] \u001b[39m\u001b[92m+ XZ_jll v5.8.1+0\u001b[39m\n  \u001b[90m[f67eecfb] \u001b[39m\u001b[92m+ Xorg_libICE_jll v1.1.2+0\u001b[39m\n  \u001b[90m[c834827a] \u001b[39m\u001b[92m+ Xorg_libSM_jll v1.2.6+0\u001b[39m\n  \u001b[90m[4f6342f7] \u001b[39m\u001b[92m+ Xorg_libX11_jll v1.8.12+0\u001b[39m\n  \u001b[90m[0c0b7dd1] \u001b[39m\u001b[92m+ Xorg_libXau_jll v1.0.13+0\u001b[39m\n  \u001b[90m[935fb764] \u001b[39m\u001b[92m+ Xorg_libXcursor_jll v1.2.4+0\u001b[39m\n  \u001b[90m[a3789734] \u001b[39m\u001b[92m+ Xorg_libXdmcp_jll v1.1.6+0\u001b[39m\n  \u001b[90m[1082639a] \u001b[39m\u001b[92m+ Xorg_libXext_jll v1.3.7+0\u001b[39m\n  \u001b[90m[d091e8ba] \u001b[39m\u001b[92m+ Xorg_libXfixes_jll v6.0.1+0\u001b[39m\n  \u001b[90m[a51aa0fd] \u001b[39m\u001b[92m+ Xorg_libXi_jll v1.8.3+0\u001b[39m\n  \u001b[90m[d1454406] \u001b[39m\u001b[92m+ Xorg_libXinerama_jll v1.1.6+0\u001b[39m\n  \u001b[90m[ec84b674] \u001b[39m\u001b[92m+ Xorg_libXrandr_jll v1.5.5+0\u001b[39m\n  \u001b[90m[ea2f1a96] \u001b[39m\u001b[92m+ Xorg_libXrender_jll v0.9.12+0\u001b[39m\n  \u001b[90m[c7cfdc94] \u001b[39m\u001b[92m+ Xorg_libxcb_jll v1.17.1+0\u001b[39m\n  \u001b[90m[cc61e674] \u001b[39m\u001b[92m+ Xorg_libxkbfile_jll v1.1.3+0\u001b[39m\n  \u001b[90m[e920d4aa] \u001b[39m\u001b[92m+ Xorg_xcb_util_cursor_jll v0.1.4+0\u001b[39m\n  \u001b[90m[12413925] \u001b[39m\u001b[92m+ Xorg_xcb_util_image_jll v0.4.0+1\u001b[39m\n  \u001b[90m[2def613f] \u001b[39m\u001b[92m+ Xorg_xcb_util_jll v0.4.0+1\u001b[39m\n  \u001b[90m[975044d2] \u001b[39m\u001b[92m+ Xorg_xcb_util_keysyms_jll v0.4.0+1\u001b[39m\n  \u001b[90m[0d47668e] \u001b[39m\u001b[92m+ Xorg_xcb_util_renderutil_jll v0.3.9+1\u001b[39m\n  \u001b[90m[c22f9ab0] \u001b[39m\u001b[92m+ Xorg_xcb_util_wm_jll v0.4.1+1\u001b[39m\n  \u001b[90m[35661453] \u001b[39m\u001b[92m+ Xorg_xkbcomp_jll v1.4.7+0\u001b[39m\n  \u001b[90m[33bec58e] \u001b[39m\u001b[92m+ Xorg_xkeyboard_config_jll v2.44.0+0\u001b[39m\n  \u001b[90m[c5fb5394] \u001b[39m\u001b[92m+ Xorg_xtrans_jll v1.6.0+0\u001b[39m\n  \u001b[90m[3161d3a3] \u001b[39m\u001b[92m+ Zstd_jll v1.5.7+1\u001b[39m\n  \u001b[90m[35ca27e7] \u001b[39m\u001b[92m+ eudev_jll v3.2.9+0\u001b[39m\n  \u001b[90m[214eeab7] \u001b[39m\u001b[92m+ fzf_jll v0.61.1+0\u001b[39m\n  \u001b[90m[1a1c6b14] \u001b[39m\u001b[92m+ gperf_jll v3.3.0+0\u001b[39m\n  \u001b[90m[a4ae2306] \u001b[39m\u001b[92m+ libaom_jll v3.11.0+0\u001b[39m\n  \u001b[90m[0ac62f75] \u001b[39m\u001b[92m+ libass_jll v0.15.2+0\u001b[39m\n  \u001b[90m[1183f4f0] \u001b[39m\u001b[92m+ libdecor_jll v0.2.2+0\u001b[39m\n  \u001b[90m[2db6ffa8] \u001b[39m\u001b[92m+ libevdev_jll v1.11.0+0\u001b[39m\n  \u001b[90m[f638f0a6] \u001b[39m\u001b[92m+ libfdk_aac_jll v2.0.3+0\u001b[39m\n  \u001b[90m[36db933b] \u001b[39m\u001b[92m+ libinput_jll v1.18.0+0\u001b[39m\n  \u001b[90m[b53b4c65] \u001b[39m\u001b[92m+ libpng_jll v1.6.48+0\u001b[39m\n  \u001b[90m[f27f6e37] \u001b[39m\u001b[92m+ libvorbis_jll v1.3.7+2\u001b[39m\n  \u001b[90m[009596ad] \u001b[39m\u001b[92m+ mtdev_jll v1.1.6+0\u001b[39m\n\u001b[33m⌅\u001b[39m \u001b[90m[1270edf5] \u001b[39m\u001b[92m+ x264_jll v2021.5.5+0\u001b[39m\n\u001b[33m⌅\u001b[39m \u001b[90m[dfaa095f] \u001b[39m\u001b[92m+ x265_jll v3.5.0+0\u001b[39m\n  \u001b[90m[d8fb68d0] \u001b[39m\u001b[92m+ xkbcommon_jll v1.8.1+0\u001b[39m\n  \u001b[90m[0dad84c5] \u001b[39m\u001b[92m+ ArgTools v1.1.2\u001b[39m\n  \u001b[90m[56f22d72] \u001b[39m\u001b[92m+ Artifacts v1.11.0\u001b[39m\n  \u001b[90m[2a0f44e3] \u001b[39m\u001b[92m+ Base64 v1.11.0\u001b[39m\n  \u001b[90m[ade2ca70] \u001b[39m\u001b[92m+ Dates v1.11.0\u001b[39m\n  \u001b[90m[f43a241f] \u001b[39m\u001b[92m+ Downloads v1.6.0\u001b[39m\n  \u001b[90m[7b1f6079] \u001b[39m\u001b[92m+ FileWatching v1.11.0\u001b[39m\n  \u001b[90m[9fa8497b] \u001b[39m\u001b[92m+ Future v1.11.0\u001b[39m\n  \u001b[90m[b77e0a4c] \u001b[39m\u001b[92m+ InteractiveUtils v1.11.0\u001b[39m\n  \u001b[90m[b27032c2] \u001b[39m\u001b[92m+ LibCURL v0.6.4\u001b[39m\n  \u001b[90m[76f85450] \u001b[39m\u001b[92m+ LibGit2 v1.11.0\u001b[39m\n  \u001b[90m[8f399da3] \u001b[39m\u001b[92m+ Libdl v1.11.0\u001b[39m\n  \u001b[90m[37e2e46d] \u001b[39m\u001b[92m+ LinearAlgebra v1.11.0\u001b[39m\n  \u001b[90m[56ddb016] \u001b[39m\u001b[92m+ Logging v1.11.0\u001b[39m\n  \u001b[90m[d6f4376e] \u001b[39m\u001b[92m+ Markdown v1.11.0\u001b[39m\n  \u001b[90m[a63ad114] \u001b[39m\u001b[92m+ Mmap v1.11.0\u001b[39m\n  \u001b[90m[ca575930] \u001b[39m\u001b[92m+ NetworkOptions v1.2.0\u001b[39m\n  \u001b[90m[44cfe95a] \u001b[39m\u001b[92m+ Pkg v1.11.0\u001b[39m\n  \u001b[90m[de0858da] \u001b[39m\u001b[92m+ Printf v1.11.0\u001b[39m\n  \u001b[90m[3fa0cd96] \u001b[39m\u001b[92m+ REPL v1.11.0\u001b[39m\n  \u001b[90m[9a3f8284] \u001b[39m\u001b[92m+ Random v1.11.0\u001b[39m\n  \u001b[90m[ea8e919c] \u001b[39m\u001b[92m+ SHA v0.7.0\u001b[39m\n  \u001b[90m[9e88b42a] \u001b[39m\u001b[92m+ Serialization v1.11.0\u001b[39m\n  \u001b[90m[6462fe0b] \u001b[39m\u001b[92m+ Sockets v1.11.0\u001b[39m\n  \u001b[90m[2f01184e] \u001b[39m\u001b[92m+ SparseArrays v1.11.0\u001b[39m\n  \u001b[90m[f489334b] \u001b[39m\u001b[92m+ StyledStrings v1.11.0\u001b[39m\n  \u001b[90m[4607b0f0] \u001b[39m\u001b[92m+ SuiteSparse\u001b[39m\n  \u001b[90m[fa267f1f] \u001b[39m\u001b[92m+ TOML v1.0.3\u001b[39m\n  \u001b[90m[a4e569a6] \u001b[39m\u001b[92m+ Tar v1.10.0\u001b[39m\n  \u001b[90m[8dfed614] \u001b[39m\u001b[92m+ Test v1.11.0\u001b[39m\n  \u001b[90m[cf7118a7] \u001b[39m\u001b[92m+ UUIDs v1.11.0\u001b[39m\n  \u001b[90m[4ec0a83e] \u001b[39m\u001b[92m+ Unicode v1.11.0\u001b[39m\n  \u001b[90m[e66e0078] \u001b[39m\u001b[92m+ CompilerSupportLibraries_jll v1.1.1+0\u001b[39m\n  \u001b[90m[deac9b47] \u001b[39m\u001b[92m+ LibCURL_jll v8.6.0+0\u001b[39m\n  \u001b[90m[e37daf67] \u001b[39m\u001b[92m+ LibGit2_jll v1.7.2+0\u001b[39m\n  \u001b[90m[29816b5a] \u001b[39m\u001b[92m+ LibSSH2_jll v1.11.0+1\u001b[39m\n  \u001b[90m[c8ffd9c3] \u001b[39m\u001b[92m+ MbedTLS_jll v2.28.6+0\u001b[39m\n  \u001b[90m[14a3606d] \u001b[39m\u001b[92m+ MozillaCACerts_jll v2023.12.12\u001b[39m\n  \u001b[90m[4536629a] \u001b[39m\u001b[92m+ OpenBLAS_jll v0.3.27+1\u001b[39m\n  \u001b[90m[05823500] \u001b[39m\u001b[92m+ OpenLibm_jll v0.8.5+0\u001b[39m\n  \u001b[90m[efcefdf7] \u001b[39m\u001b[92m+ PCRE2_jll v10.42.0+1\u001b[39m\n  \u001b[90m[bea87d4a] \u001b[39m\u001b[92m+ SuiteSparse_jll v7.7.0+0\u001b[39m\n  \u001b[90m[83775a58] \u001b[39m\u001b[92m+ Zlib_jll v1.2.13+1\u001b[39m\n  \u001b[90m[8e850b90] \u001b[39m\u001b[92m+ libblastrampoline_jll v5.11.0+0\u001b[39m\n  \u001b[90m[8e850ede] \u001b[39m\u001b[92m+ nghttp2_jll v1.59.0+0\u001b[39m\n  \u001b[90m[3f19e933] \u001b[39m\u001b[92m+ p7zip_jll v17.4.0+2\u001b[39m\n\u001b[36m\u001b[1m        Info\u001b[22m\u001b[39m Packages marked with \u001b[32m⌃\u001b[39m and \u001b[33m⌅\u001b[39m have new versions available. Those with \u001b[32m⌃\u001b[39m may be upgradable, but those with \u001b[33m⌅\u001b[39m are restricted by compatibility constraints from upgrading. To see why use `status --outdated -m`\n"
                }
            ],
            "execution_count": 1
        },
        {
            "id": "3",
            "cell_type": "markdown",
            "metadata": {
            },
            "source": [
                "# Normal Multivariada\n",
                "\n",
                "Dizemos que $\\boldsymbol{X} = \\left(\\begin{array}{c}X_1 \\\\ \\vdots \\\\ X_n\\end{array}\\right)$ tem distribuição multivariada\n",
                "$N_d(\\boldsymbol{\\mu}, \\Sigma)$ se, e somente se, a sua função densidade de probabilidade é dada por:\n",
                "\n",
                "$$\n",
                "f^{\\boldsymbol{X}}(\\boldsymbol{x}) = \\frac{1}{(2\\pi)^{\\frac{d}{2}} \\lvert \\Sigma \\rvert^{\\frac{1}{2}}}\n",
                "\\mathrm{Exp}\\left\\{-\\frac{1}{2} (\\boldsymbol{x} - \\boldsymbol{\\mu})^T \\Sigma^{-1}(\\boldsymbol{x}-\\boldsymbol{\\mu})\\right\\}\n",
                "$$\n",
                "\n",
                "em que $\\mu=\\left(\\begin{array}{c} \\mu_1, \\vdots, \\mu_n\\end{array}\\right)$ e $\\Sigma = \\left[\\begin{array}{cccc}\n",
                "\\sigma_{11} & \\sigma_{12} & \\dots & \\sigma_{1d} \\\\\n",
                "\\sigma_{21} & \\sigma_{22} & \\dots & \\sigma_{2d} \\\\\n",
                "\\vdots & \\vdots & \\ddots & \\vdots \\\\\n",
                "\\sigma_{d1} & \\dots & \\sigma_{dd-1} & \\sigma_{dd}\n",
                "\\end{array}\\right]\n",
                "$\n",
                "é uma matriz simétrica positiva definida, ou seja, $\\boldsymbol{y}^T \\Sigma \\boldsymbol{y} > 0, \\forall y \\in \\mathbb{R}^d \\setminus \\{\\boldsymbol{0}\\}$\n",
                "\n",
                ":::{.callout-note title=\"Notação\"}\n",
                "$$\n",
                "\\boldsymbol{X} \\sim N_d(\\boldsymbol{\\mu}, \\Sigma)\n",
                "$$\n",
                ":::\n",
                "\n",
                ":::{.callout-note title=\"Obs 1: Caso particular: Normal univariada\"}\n",
                "Se $d=1$, então \n",
                "$\\boldsymbol{X} = X_1$ e $X_1 \\sim N_1(\\mu_1,\\sigma_{11})$\n",
                ":::\n",
                "\n",
                "\n",
                ":::{.callout-note title=\"Obs 2: Esperança e (co)variância\"}\n",
                "Pode-se mostrar que:\n",
                "$$\n",
                "E(\\boldsymbol{X}) = \\left(\n",
                "\\begin{array}{c}\n",
                "E(X_1) \\\\\n",
                "\\vdots \\\\\n",
                "E(X_d)\n",
                "\\end{array}\n",
                "\\right) = \\boldsymbol{\\mu}\n",
                "$$\n",
                "e\n",
                "$$\n",
                "\\mathrm{Var}(\\boldsymbol{X}) = E((\\boldsymbol{X} - \\boldsymbol{\\mu})(\\boldsymbol{X} - \\boldsymbol{\\mu})^T) = \\Sigma\n",
                "$$\n",
                "ou seja,\n",
                "$$\n",
                "\\mathrm{Cov}(X_i, X_j) = \\sigma_{i,j}, i, j = 1, \\dots, d\n",
                "$$\n",
                ":::\n",
                "\n",
                "\n",
                ":::{.callout-note title=\"Obs 3: Covariância implica independência para normais\"}\n",
                "Se\n",
                "$$\n",
                "\\Sigma = \\mathrm{diag}(\\sigma_{11}\\dots\\sigma_{dd}) = \\left[\\begin{array}{cccc}\n",
                "\\sigma_{11} & 0 & \\dots & 0 \\\\\n",
                "0 & \\sigma_{22} & \\dots & 0 \\\\\n",
                "\\vdots & \\vdots & \\ddots & \\vdots \\\\\n",
                "0 & \\dots & 0 & \\sigma_{dd}\n",
                "\\end{array}\\right]\n",
                "$$\n",
                "então $X_1, \\dots, X_d$ são independentes.\n",
                "\n",
                "Ou seja, se $X_1, \\dots, X_d$ forem não correlacionadas (covariância zero), então serão independentes. Em outras\n",
                "distribuições multivariadas, isso não é certo.\n",
                ":::\n",
                "\n",
                "\n",
                "\n",
                ":::{.callout-note title=\"Obs 4: Caso de independência\"}\n",
                "Se $\\Sigma = \\mathrm{diag}(\\sigma_{11} \\dots \\sigma_{dd})$, então\n",
                "$$\n",
                "\\lvert \\Sigma \\rvert  = \\prod^d_{i=1} \\sigma_{ii}, \\Sigma^{-1} =\n",
                "\\left[\\begin{array}{cccc}\n",
                "\\sigma_{11}^{-1} & 0 & \\dots & 0 \\\\\n",
                "0 & \\sigma_{22}^{-1} & \\dots & 0 \\\\\n",
                "\\vdots & \\vdots & \\ddots & \\vdots \\\\\n",
                "0 & \\dots & 0 & \\sigma_{dd}^{-1}\n",
                "\\end{array}\\right]\n",
                "$$\n",
                "e\n",
                "$$\n",
                "\\begin{aligned}\n",
                "(\\boldsymbol{x} - \\boldsymbol{\\mu})^{T}\\Sigma^{-1}(\\boldsymbol{x} - \\boldsymbol{\\mu}) &=\n",
                "\\left(\\begin{array}{c}\n",
                "x_1 - \\mu_1 \\\\\n",
                "\\vdots \\\\\n",
                "x_d - \\mu_d \\\\\n",
                "\\end{array}\\right)^T\n",
                "\\left[\\begin{array}{cccc}\n",
                "\\sigma_{11}^{-1} & 0 & \\dots & 0 \\\\\n",
                "0 & \\sigma_{22}^{-1} & \\dots & 0 \\\\\n",
                "\\vdots & \\vdots & \\ddots & \\vdots \\\\\n",
                "0 & \\dots & 0 & \\sigma_{dd}^{-1}\n",
                "\\end{array}\\right]\n",
                "\\left(\\begin{array}{c}\n",
                "x_1 - \\mu_1 \\\\\n",
                "\\vdots \\\\\n",
                "x_d - \\mu_d \\\\\n",
                "\\end{array}\\right) \\\\\n",
                "&=\n",
                "\\left(\n",
                "\\frac{(x_1 - \\mu_1}{\\sigma_{11}} \\dots \\frac{x_d - \\mu_d}{\\sigma_{dd}}\n",
                "\\right)\n",
                "\\left(\\begin{array}{c}\n",
                "x_1 - \\mu_1 \\\\\n",
                "\\vdots \\\\\n",
                "x_d - \\mu_d \\\\\n",
                "\\end{array}\\right) \\\\\n",
                "&= \\frac{(x_1 - \\mu_1)^2}{\\sigma_{11}} +\\dots +\\frac{(x_d - \\mu_d)^2}{\\sigma_{dd}}\n",
                "\\end{aligned}\n",
                "$$\n",
                "Portanto, a f.d.p de $X$ quando $\\Sigma = \\mathrm{diag}(\\sigma_{11} \\dots \\sigma_{dd})$ é\n",
                "$$\n",
                "\\begin{aligned}\n",
                "f^{\\boldsymbol{X}}(\\boldsymbol{x}) &= \\frac{1}{(2\\pi)^{\\frac{d}{2}} \\left(\\prod \\sigma_{ii}\\right)^{\\frac{1}{2}}}\n",
                "\\mathrm{Exp}\\left\\{-\\frac{1}{2}\\sum^d \\frac{(x_i - \\mu_i)^2}{(\\sigma_{ii})}\\right\\} \\\\\n",
                "&= \\prod \\left\\{\n",
                "\\frac{1}{(2\\pi)^{\\frac{d}{2}} \\sigma_{ii}^{\\frac{1}{2}}}\n",
                "\\mathrm{Exp}\\left\\{-\\frac{1}{2} \\frac{(x_i - \\mu_i)^2 }{(\\sigma_{ii})}\\right\\}\n",
                "\\right\\} \\\\\n",
                "&= \\prod^d_{i=1} f^{(i)}(x_i)\n",
                "\\end{aligned}\n",
                "$$\n",
                "em que $f^{(i)}(x_i)$ é  a f.d.p de $N(\\mu_i, \\sigma_{ii})$\n",
                ":::\n",
                "\n",
                ":::{.callout-note title=\"Obs 5: Função geradora de momentos\"}\n",
                "A função geradora de momentos de $\\boldsymbol{X} \\sim N_d(\\boldsymbol{\\mu} \\Sigma)$ é dada por\n",
                "$$\n",
                "M_{\\boldsymbol{X}}(\\boldsymbol{t}) = \\mathrm{Exp}\\left\\{\n",
                "\\boldsymbol{\\mu}^T\\boldsymbol{t} + \\frac{1}{2} \\boldsymbol{t}^T \\Sigma \\boldsymbol{t}, \\forall \\boldsymbol{t} \\in \\mathbb{R}^d\n",
                "\\right\\}\n",
                "$$\n",
                ":::\n",
                "\n",
                ":::{.callout-note title=\"Obs 6: Transformações para normais generalizadas\"}\n",
                "Se $\\boldsymbol{Y} = \\boldsymbol{a} + B\\boldsymbol{X}$, em que $\\boldsymbol{a} \\in \\mathbb{R}^m$ e $B$ é uma matriz $m\\times d$, em que\n",
                "$m \\leq d$ cujas linhas são linearmente independentes, então,\n",
                "$$\n",
                "\\boldsymbol{Y} \\sim N_m(\\boldsymbol{a} + B \\boldsymbol{\\mu}, B \\Sigma B^T).\n",
                "$$\n",
                "Prova por F.G.M:\n",
                "$$\n",
                "\\begin{aligned}\n",
                "M_{\\boldsymbol{Y}}(\\boldsymbol{t} &= E(\\mathrm{e}^{\\boldsymbol{Y}^T\\boldsymbol{t}}) \\\\\n",
                "&= E(\\mathrm{e}^{\\boldsymbol{a}^T \\boldsymbol{t} + \\boldsymbol{X}^T B^T \\boldsymbol{t}}) \\\\\n",
                "&= \\mathrm{e}^{\\boldsymbol{a}^T\\boldsymbol{t}}E(\\mathrm{e}^{\\boldsymbol{X}^T B^T \\boldsymbol{t}}) \\\\\n",
                "&= \\mathrm{e}^{\\boldsymbol{a}^T\\boldsymbol{t}} M_{\\boldsymbol{X}}(B^T \\boldsymbol{t}) \\\\\n",
                "&= \\mathrm{e}^{\\boldsymbol{a}^T\\boldsymbol{t}} \\mathrm{e}^{\\boldsymbol{\\mu}(B^T\\boldsymbol{t}) + \\frac{1}{2} \\boldsymbol{t}^T B \\Sigma B^T \\boldsymbol{t}}\\\\\n",
                "&= \\mathrm{e}^{(\\boldsymbol{a} + B\\boldsymbol{\\mu})^T\\boldsymbol{t} + \\frac{1}{2} \\boldsymbol{t}^T B \\Sigma B^T \\boldsymbol{t}}\n",
                "\\end{aligned}\n",
                "$$\n",
                "\n",
                "Observações adicionais:\n",
                "\n",
                "Se tomarmos $B = \\Sigma^{-\\frac{1}{2}}$, então $B\\cdot B = \\Sigma^{-1}$ e $B \\Sigma B^{T} = I$. Ademais, tomando\n",
                "$\\boldsymbol{a} = - \\Sigma^{-\\frac{1}{2}}\\boldsymbol{\\mu}$, temos que\n",
                "$$\n",
                "\\boldsymbol{Y} = \\Sigma^{-\\frac{1}{2}} \\boldsymbol{X} - \\Sigma^{-\\frac{1}{2}}\\boldsymbol{\\mu} = \\Sigma^{-\\frac{1}{2}}(\\boldsymbol{X} - \\boldsymbol{\\mu}) \\sim N_d(0,I)\n",
                "$$\n",
                "\n",
                "Como $\\Sigma$ é uma matriz quadrada simétrica e positiva definida, todos seus autovalores são estritamente positivas. Logo,\n",
                "$$\n",
                "\\Sigma = \\Gamma \\Lambda \\Gamma^T\n",
                "$$\n",
                "em que $\\Gamma$ é a matriz diagonal de autovetores de $\\Sigma$ e $\\Lambda$ é a matriz diagonal de autovalores de $\\Sigma$.\n",
                "\n",
                "Pode-se mostrar que $\\Sigma^{-1} = \\Gamma \\Lambda^{-1}\\Gamma^T$ e $\\Sigma^{-\\frac{1}{2}} = \\Gamma \\Lambda^{-\\frac{1}{2}}\\Gamma^T$\n",
                "em que\n",
                "$$\n",
                "\\Lambda^k = \\begin{bmatrix}\n",
                "\\lambda_1^k & 0 & \\dots & 0 \\\\\n",
                "0 & \\lambda_2^k & \\dots & 0 \\\\\n",
                "\\vdots & \\vdots & \\ddots & \\vdots \\\\\n",
                "0 & \\dots & 0 & \\lambda_d^k\\\\\n",
                "\\end{bmatrix}\n",
                "$$\n",
                "\n",
                "Note ainda que\n",
                "$$\n",
                "\\lvert \\Sigma \\rvert = \\lvert \\Gamma \\Lambda \\Gamma^T \\rvert = \\lvert \\Lambda \\Gamma^T \\Gamma \\rvert\n",
                "$$\n",
                "como $\\Gamma^T \\Gamma = I$,\n",
                "$$\n",
                "\\lvert \\Sigma \\rvert = \\lvert \\Lambda \\rvert = \\prod^d_{i=1} \\lambda_i\n",
                "$$\n",
                "\n",
                "Além disso,\n",
                "$$\n",
                "\\mathrm{tr}\\{\\Sigma\\} = \\mathrm{tr}\\{\\Gamma \\Lambda \\Gamma^T\\} = \\mathrm{tr}\\{\\Lambda\\Gamma^T\\Gamma\\} = \\mathrm{tr}\\{\\Lambda\\} = \\sum^d_{i=1} \\lambda_1\n",
                "$$"
            ]
        },
        {
            "id": "4",
            "cell_type": "code",
            "metadata": {
            },
            "source": [
                "#|eval: false\n",
                "using LinearAlgebra, Distributions, Random\n",
                "Random.seed!(10)\n",
                "d = Normal(3,1)\n",
                "a = rand(d, 3, 3)\n",
                "b = a * transpose(a)\n",
                "L = Diagonal(eigvals(b))\n",
                "G = eigvecs(b)\n",
                "println(\"Gama: $G\")\n",
                "println(\"Lambda: $L\")\n",
                "println(\"Matriz raiz quadrada (direto): $(b^(-1/2))\")\n",
                "println(\"Matriz raiz quadrada (decomposição): $(G * sqrt.(L) * transpose(G))\")\n",
                "println(\"Traço (direto): $(tr(b))\")\n",
                "println(\"Traço (por Lambda): $(tr(L))\")"
            ],
            "outputs": [
                {
                    "output_type": "stream",
                    "name": "stdout",
                    "text": "Gama: [-0.0781938403804398 0.8187246888736395 -0.5688370655603594; -0.7535667662902741 -0.4221060116854977 -0.5039480564917201; 0.6527042608022241 -0.3892510741510224 -0.649969806377879]\nLambda: [1.0064704163817877 0.0 0.0; 0.0 4.230309223634049 0.0; 0.0 0.0 94.60546645999227]\nMatriz raiz quadrada (direto): [0.36526591853158563 -0.07981782206991739 -0.16780739424387442; -0.07981782206991739 0.6787727253813357 -0.37671162495277566; -0.16780739424387442 -0.37671162495277566 0.5417521757532208]\nMatriz raiz quadrada (decomposição): [4.532077996012441 2.136568204925103 2.8894877572834767; 2.136568204925103 3.4063452707046893 3.030429555520614; 2.8894877572834763 3.030429555520614 4.848112422922358]\nTraço (direto): 99.8422461000081\nTraço (por Lambda): 99.84224610000811\n"
                }
            ],
            "execution_count": 1
        },
        {
            "id": "5",
            "cell_type": "markdown",
            "metadata": {
            },
            "source": [
                ":::\n",
                "\n",
                ":::{.callout-note title=\"Obs 7: Normais marginais\"}\n",
                "Se $\\boldsymbol{X} \\sim N_d(\\boldsymbol{\\mu}, \\Sigma)$, então $X_i \\sim N(\\mu_i, \\sigma_{ii}), i = 1,\\dots d$\n",
                "\n",
                "Demonstração:\n",
                "\n",
                "Tomando $\\boldsymbol{a} = 0$ e $B_i = (0 \\dots 1 \\dots 0)$ ($1$ na $i$-ésima posição), temos que\n",
                "$$\n",
                "a + B_i \\boldsymbol{X} = X_i \\sim N_1(\\mu_i, \\sigma_{ii})\n",
                "$$\n",
                "pelo resultado 6. Note que\n",
                "$$\n",
                "B_i \\Sigma B^T_i = \\sigma_{ii}.\n",
                "$$\n",
                ":::\n",
                "\n",
                "\n",
                "## Normal bivariada $d=2$\n",
                "\n",
                "$$\n",
                "\\boldsymbol{X} = \\left(\\begin{array}{c} X_1 \\\\ X_2 \\end{array}\\right) \\sim N_2 (\\boldsymbol{\\mu}, \\Sigma)\n",
                "$$\n",
                "em que $\\boldsymbol{\\mu} =\\left(\\begin{array}{c} \\mu_1 \\\\ \\mu_2 \\end{array}\\right)$ e\n",
                "$\\Sigma = \\left(\\begin{array}{cc} \\sigma_{11} & \\sigma_{12} \\\\ \\sigma_{12} & \\sigma_{22} \\end{array}\\right)$ é simétrica\n",
                "positiva definida.\n",
                "\n",
                "$$\n",
                "\\begin{aligned}\n",
                "\\lvert \\Sigma \\rvert &= \\sigma_{11} \\sigma_{22} - \\sigma_{12}^2 \\\\\n",
                "\\Sigma^{-1} =& \\frac{1}{\\sigma_{11} \\sigma_{22} - \\sigma_{12}^2}\n",
                "\\left(\\begin{array}{cc} \\sigma_{11} & -\\sigma_{12} \\\\ -\\sigma_{12} & \\sigma_{22} \\end{array}\\right) \\\\\n",
                "\\Rightarrow f^{\\boldsymbol{X}}(x_1, x_2)\\\\ = \\frac{1}{2\\pi \\sqrt{\\sigma_{11}\\sigma_{22} - \\sigma_{12}^2}}\n",
                "&\\mathrm{Exp}\\underbracket{\\left\\{\n",
                "-\\frac{1}{2} \\left(\\begin{array}{c} X_1 - \\mu_1 \\\\ X_2 - \\mu_2 \\end{array}\\right)^T\n",
                "\\left(\\begin{array}{cc} \\sigma_{11} & -\\sigma_{12} \\\\ -\\sigma_{12} & \\sigma_{22} \\end{array}\\right)\n",
                "\\left(\\begin{array}{c} X_1 - \\mu_1 \\\\ X_2 - \\mu_2 \\end{array}\\right) \\frac{1}{\\sigma_{11}\\sigma_{22} - \\sigma_{12}^2}\n",
                "\\right\\}}_{*} \\\\ \\\\\n",
                "*&= [(x_1 - \\mu_1)\\sigma_{22} - (x_2 - \\mu_2)\\sigma_{12} - (x_1-\\mu_1)\\sigma_{12}+(x_2 - \\mu_2)\\sigma_{11}]\n",
                "\\left(\\begin{array}{c} X_1 - \\mu_1 \\\\ X_2 - \\mu_2 \\end{array}\\right)^T \\\\\n",
                "&= (x_1 - \\mu_1)^2 \\sigma_{22} - 2(x_1 - \\mu_1)(x_2 - \\mu_2)\\sigma_{12} + (x_2 - \\mu_2)^2 \\sigma_{11} \\\\\n",
                "\\Rightarrow \\frac{*}{\\sigma_{11}\\sigma_{22} - \\sigma_{12}^2} &=\n",
                "\\frac{(x_1 - \\mu_1)^2}{\\frac{\\sigma_{11}\\sigma_{22} - \\sigma_{12}^2}{\\sigma_{22}}} -\n",
                "\\frac{2(x_1 - \\mu_1)(x_2 - \\mu_2)}{\\frac{\\sigma_{11}\\sigma_{22} - \\sigma{12}^2}{\\sigma_{22}}} +\n",
                "\\frac{(x_2 - \\mu_2)^2}{\\frac{\\sigma_{11}\\sigma_{22} - \\sigma_{12}^2}{\\sigma_{22}}} \\\\\n",
                "\\mathrm{Tome}\\ \\rho = \\frac{\\sigma_{12}}{\\sqrt{\\sigma_{11} \\sigma_{22}}} \\\\ \\\\\n",
                "A.\\ \\frac{\\sigma_{11}\\sigma_{22} - \\sigma_{12}^2}{\\sigma_{22}} &= \\sigma_{11} - \\frac{\\sigma_{12}^2}{\\sigma_{22}} \\\\\n",
                "&= \\sigma_{11} - \\sigma_{11}\\frac{\\sigma_{12}^2}{\\sigma_{11}\\sigma_{22}} \\\\\n",
                "&= \\sigma_{11} - \\sigma_{11} \\rho^2  \\\\\n",
                "&= \\sigma_{11}(1-\\rho^2)\\\\ \\\\\n",
                "B.\\ \\frac{\\sigma_{11} \\sigma_{22} - \\sigma_{12}^2}{\\sigma_{11}} &= \\sigma_{22}(1-\\rho^2) \\\\ \\\\\n",
                "C.\\ \\frac{\\sigma_{11}\\sigma_{22}}{\\sigma_{12}} - \\sigma_{12} &= \\sigma_{12} \\frac{\\sigma_{11}\\sigma_{22}}{\\sigma_{12}^2} - \\sigma_{12} \\\\\n",
                "&= \\sigma_{12}(\\rho^{-2} - 1) = \\sigma_{12} \\left(\\frac{1 - \\rho^2}{\\rho^2}\\right) \\\\\n",
                "\\Rightarrow \\frac{*}{\\sigma_{11}\\sigma_{22}-\\sigma_{12}^2} &= \\frac{(x_1-\\mu_1)^2}{\\sigma_{11}(1-\\rho^2)}\n",
                "-2\\rho^2\\frac{(x_1 - \\mu_1)(x_2 - \\mu_2)}{\\sigma_{12}(1-\\rho^2)} + \\frac{(x_2 - \\mu_2)^2}{\\sigma_{22}(1-\\rho^2)}\n",
                "\\end{aligned}\n",
                "$$\n",
                "\n",
                "Além disso,\n",
                "$$\n",
                "\\sqrt{\\sigma_{11}\\sigma_{22} - \\sigma_{12}^2} = \\sqrt{\\sigma_{11}\\sigma_{22}-\\rho^2\\sigma_{11}\\sigma_{22}} = \\sqrt{\\sigma_{11} \\sigma_{22}} \\sqrt{1-\\rho^2}\n",
                "$$\n",
                "\n",
                "Assim temos que\n",
                "$$\n",
                "\\begin{aligned}\n",
                "&f^{\\boldsymbol{X}}(x_1, x_2) \\\\&= \\frac{1}{2\\pi \\sqrt{\\sigma_{11}, \\sigma_{22}} \\sqrt{1-\\rho^2}}\n",
                "\\mathrm{Exp} \\left\\{\n",
                "-\\frac{1}{2(1-\\rho^2)} \\left(\\frac{(x_1-\\mu_1)^2}{\\sigma_{11}}\n",
                "-2\\rho\\frac{(x_1 - \\mu_1)(x_2 - \\mu_2)}{\\sqrt{\\sigma_{11}\\sigma_{22}}} + \\frac{(x_2 - \\mu_2)^2}{\\sigma_{22}} \\right)\n",
                "\\right\\}\n",
                "\\end{aligned}\n",
                "$$\n",
                "\n",
                "## [Modelo estatístico](./modelo-estatistico.qmd)\n",
                "\n",
                "Dizemos que $\\boldsymbol{X} = \\left(\\begin{array}{c} X_1 \\\\ \\vdots \\\\ X_d \\end{array}\\right)$ é um vetor aleatório\n",
                "populacional normal multivariado se $\\boldsymbol{X}_n \\sim N_d(\\boldsymbol{\\mu}, \\Sigma)$. em que o vetor de parâmetros\n",
                "é\n",
                "$$\n",
                "\\theta = \\left[\\begin{array}{c}\n",
                "\\mu_1 \\\\\n",
                "\\vdots \\\\\n",
                "\\mu_d \\\\\n",
                "\\sigma_{11} \\\\\n",
                "\\vdots \\\\\n",
                "\\sigma_{d1} \\\\\n",
                "\\vdots \\\\\n",
                "\\sigma_{dd}\n",
                "\\end{array}\\right] =\n",
                "\\left[\\begin{array}{c}\n",
                "\\boldsymbol{\\mu} \\\\\n",
                "\\mathrm{vech}\\Sigma\n",
                "\\end{array}\\right] = (\\boldsymbol{\\mu}^T, (\\mathrm{vech}\\Sigma)^T)^T\n",
                "$$\n",
                "\n",
                "em que $\\mathrm{vech}\\Sigma$ é o vetor coluna com os elementos da triangular superior da matriz removidos:\n",
                "$$\n",
                "\\mathrm{vech} \\left(\\begin{array}{cc}\\sigma_{11} & \\sigma_{12} \\\\ \\sigma_{12} & \\sigma_{22} \\end{array}\\right) =\n",
                "\\left(\\begin{array}{c} \\sigma_{11} \\\\ \\sigma_{12} \\\\ \\sigma_{22} \\end{array}\\right)\n",
                "$$\n",
                "\n",
                "## [Amostra aleatória](populacao-e-amostra.qmd#sec-aa) de uma normal multivariada\n",
                "\n",
                "Dizemos que $\\boldsymbol{X}_1,\\dots, \\boldsymbol{X}_n$ é uma amostra aleatória de $\\boldsymbol{X} \\sim N_d(\\boldsymbol{\\mu}, \\Sigma)$ se,\n",
                "e somente se, $\\boldsymbol{X}_1,\\dots,\\boldsymbol{X}_n$ são independentes e $\\boldsymbol{X}_i \\sim N_d(\\boldsymbol{\\mu}, \\Sigma), i = 1, \\dots, n$.\n",
                "\n",
                ":::{.callout-note title=\"Notação\"}\n",
                "$$\n",
                "\\boldsymbol{X}_n^* = (\\boldsymbol{X}_1, \\dots, \\boldsymbol{X}_n)\\ \\mathrm{a.a.}\\ \\text{de}\\ \\boldsymbol{X} \\sim N_d(\\boldsymbol{\\mu}, \\Sigma) \n",
                "$$\n",
                ":::\n",
                "\n",
                "## [Função de verossimilhança](funcao-verossimilhanca.qmd)\n",
                "\n",
                "Seja $\\boldsymbol{X}^*$ a.a. de $\\boldsymbol{X} \\sim N_d(\\boldsymbol{\\mu}, \\Sigma)$, em que\n",
                "$$\n",
                "\\begin{aligned}\n",
                "\\theta &= (\\boldsymbol{\\mu}^T, \\mathrm{vech}(\\Sigma)^T)^T \\\\\n",
                "\\in \\Theta &= \\left\\{(\\boldsymbol{\\mu}^T,\\mathrm{vech}(\\Sigma)^T) \\in \\mathbb{R}^d\\times \\mathbb{R}^{\\frac{d(d+1)}{2}}\n",
                ": \\Sigma\\ \\text{é positiva definida (p.d.)}\\right\\}\\subseteq \\mathbb{R}^{d + \\frac{d(d+1)}{2}}\n",
                "\\end{aligned}\n",
                "$$\n",
                "\n",
                "A função de verossimilhança é:\n",
                "$$\n",
                "\\begin{aligned}\n",
                "\\mathcal{L}_{\\boldsymbol{x}^*}(\\theta) &=  \\prod^n_{i=1} f_\\theta^{\\boldsymbol{X}}(\\boldsymbol{x}_i) =\n",
                "\\prod \\left\\{\n",
                "\\frac{1}{(2\\pi)^{\\frac{d}{2}}\\lvert\\Sigma\\rvert^{\\frac{1}{2}}} \\mathrm{Exp}\\left\\{\n",
                "-\\frac{1}{2}(\\boldsymbol{x}_i - \\boldsymbol{\\mu})^T \\Sigma^{-1}(\\boldsymbol{x}_i - \\boldsymbol{\\mu})\n",
                "\\right\\}\n",
                "\\right\\} \\\\\n",
                "&=  \\frac{1}{(2\\pi)^{\\frac{nd}{2}}\\lvert\\Sigma\\rvert^{\\frac{1}{2}}} \\mathrm{Exp}\\left\\{\n",
                "-\\frac{1}{2}\\underbracket{\\sum^n(\\boldsymbol{x}_i - \\boldsymbol{\\mu})^T \\Sigma^{-1}(\\boldsymbol{x}_i - \\boldsymbol{\\mu})}_{\\dagger}\n",
                "\\right\\}\n",
                "\\end{aligned}\n",
                "$$\n",
                "\n",
                "Defina $\\bar{\\boldsymbol{x}} = \\frac{1}{n} \\sum^n \\boldsymbol{x}_i$, então\n",
                "$$\n",
                "\\begin{aligned}\n",
                "\\dagger &= \\sum^n (\\boldsymbol{x}_i - \\bar{\\boldsymbol{x}} + \\bar{\\boldsymbol{x}} - \\boldsymbol{\\mu})^T\n",
                "\\Sigma^{-1} (\\boldsymbol{x}_i - \\bar{\\boldsymbol{x}} + \\bar{\\boldsymbol{x}} - \\boldsymbol{\\mu}) \\\\\n",
                "&= \\sum^n ((\\boldsymbol{x}_i - \\bar{\\boldsymbol{x}}) - (\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}}))^T\n",
                "\\Sigma^{-1} ((\\boldsymbol{x}_i - \\bar{\\boldsymbol{x}}) - (\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}})) \\\\\n",
                "&= \\sum^n \\left\\{\n",
                "(\\boldsymbol{x} - \\bar{\\boldsymbol{x}})^T \\Sigma^{-1} (\\boldsymbol{x}_i - \\bar{\\boldsymbol{x}})\n",
                "-\\underbracket{(\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}})^T \\Sigma^{-1} (\\boldsymbol{x}_i - \\bar{\\boldsymbol{x}})}_{A} \\right .\\\\\n",
                "&\\left.-\\underbracket{(\\boldsymbol{x}_i - \\bar{\\boldsymbol{x}})^T \\Sigma^{-1} (\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}})}_{B}\n",
                "+(\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}})^T \\Sigma^{-1} (\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}})\n",
                "\\right\\}\n",
                "\\end{aligned}\n",
                "$$\n",
                "\n",
                "Como $n\\bar{\\boldsymbol{x}} = \\sum^n \\boldsymbol{x}_i$, temos que\n",
                "\n",
                "$$\n",
                "\\begin{cases} \n",
                "A = \\sum^n (\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}})^T \\Sigma^{-1} (\\boldsymbol{x}_i - \\bar{\\boldsymbol{x}}) =\n",
                "(\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}})^T \\Sigma^{-1} (\\sum^n \\boldsymbol{x}_i - \\bar{\\boldsymbol{x}}) = 0 \\\\\n",
                "B = \\sum^n (\\boldsymbol{x}_i - \\bar{\\boldsymbol{x}})^T \\Sigma^{-1} (\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}}) =\n",
                "(\\sum^n \\boldsymbol{x}_i - \\bar{\\boldsymbol{x}})^T \\Sigma^{-1} (\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}}) = 0\n",
                "\\end{cases}\n",
                "$$\n",
                "\n",
                "Portanto,\n",
                "$$\n",
                "\\begin{aligned}\n",
                "\\dagger &= \n",
                "\\sum^n (\\boldsymbol{x} - \\bar{\\boldsymbol{x}})^T \\Sigma^{-1} (\\boldsymbol{x}_i - \\bar{\\boldsymbol{x}})\n",
                "+n(\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}})^T \\Sigma^{-1} (\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}}) \\\\\n",
                "&=  \\sum^n \\mathrm{tr}\\{(\\boldsymbol{x} - \\bar{\\boldsymbol{x}})^T \\Sigma^{-1} (\\boldsymbol{x}_i - \\bar{\\boldsymbol{x}})\\}\n",
                "+n(\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}})^T \\Sigma^{-1} (\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}}) \\\\\n",
                "&\\stackrel{\\text{Prop. tr}}{=}  \\sum^n \\mathrm{tr}\\{\\Sigma^{-1}(\\boldsymbol{x} - \\bar{\\boldsymbol{x}})(\\boldsymbol{x}_i - \\bar{\\boldsymbol{x}})^T\\}\n",
                "+n(\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}})^T \\Sigma^{-1} (\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}}) \\\\\n",
                "\\end{aligned}\n",
                "$$\n",
                "\n",
                "Note que $\\sum^n \\mathrm{tr}\\{A \\boldsymbol{y}_i\\} = \\mathrm{tr}\\{A \\sum \\boldsymbol{y}_i\\}$, usando essa propriedade,\n",
                "$$\n",
                "\\begin{aligned}\n",
                "\\dagger &= n \\mathrm{tr} \\{\\Sigma^{-1}S^2(\\boldsymbol{x}_n^*)\\}\n",
                "+n(\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}})^T \\Sigma^{-1} (\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}}) \\\\\n",
                "\\end{aligned}\n",
                "$$\n",
                "em que $S^2(\\boldsymbol{x}_n^*) = \\frac{1}{n} \\sum^n (\\boldsymbol{x}_i - \\bar{\\boldsymbol{x}})(\\boldsymbol{x}_i - \\bar{\\boldsymbol{x}})^T$.\n",
                "\n",
                "Dessa forma, podemos escrever a função de verossimilhança da seguinte forma:\n",
                "\n",
                "$$\n",
                "\\mathcal{L}_{\\boldsymbol{x}^*}(\\theta) =\n",
                "\\frac{1}{(2\\pi)^{\\frac{nd}{2}}\\lvert\\Sigma\\rvert^{\\frac{1}{2}}} \\mathrm{Exp}\\left\\{\n",
                "-\\frac{n}{2}\\left( \\mathrm{tr}\\{\\Sigma^{-1}S^2(\\boldsymbol{x}_n^*)\\}\n",
                "+(\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}})^T \\Sigma^{-1}(\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}})\\right)\n",
                "\\right\\}\n",
                "$$\n",
                "\n",
                "Pelo [critério da fatoração de Neyman-Fisher](estatisticas-suficientes.qmd#sec-crit-fat), temos que $(\\bar{\\boldsymbol{X}}, S^2(\\boldsymbol{X}_n^*))$\n",
                "é uma [estatística suficiente](estatisticas-suficientes.qmd) para o modelo normal multivariado. Como $S^2(\\boldsymbol{X}^*_n)$\n",
                "é uma matriz simétrica, podemos considerar apenas $\\mathrm{vech}(S^2(\\boldsymbol{X}_n^*))$\n",
                "\n",
                "Para maximizar a função de verossimilhança em relação a $\\boldsymbol{\\mu}$, note que basta minimizar\n",
                "$$\n",
                "(\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}})^T \\Sigma^{-1}(\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}})\n",
                "$$\n",
                "note que, como $\\Sigma$ é positiva definida (p.d.), $\\Sigma^{-1}$ também é p.d. Portanto, pela definição,\n",
                "$\\boldsymbol{y}^T \\Sigma^{-1} \\boldsymbol{y} > 0, \\forall \\boldsymbol{y} \\in \\mathbb{R}^d \\setminus \\{0\\}$ e\n",
                "$(\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}})^T \\Sigma^{-1}(\\boldsymbol{\\mu} - \\bar{\\boldsymbol{x}})$ é mínimo quando $\\boldsymbol{\\mu} = \\bar{\\boldsymbol{x}}$.\n",
                "\n",
                "Para encontrar $\\Sigma$ que maximiza a função de verossimilhança, substituimos $\\boldsymbol{\\mu}$ por $\\bar{\\boldsymbol{x}}$\n",
                "e tentamos encontrar seu valor. Portanto, devemos maximizar\n",
                "$$\n",
                "\\frac{1}{(2\\pi)^{\\frac{nd}{2}}\\lvert\\Sigma\\rvert^{\\frac{1}{2}}} \\mathrm{Exp}\\left\\{\n",
                "-\\frac{n}{2} \\mathrm{tr}\\{\\Sigma^{-1}S^2(\\boldsymbol{x}_n^*)\\}\n",
                "\\right\\}\n",
                "$$\n",
                "em relação a $\\Sigma$. Aplicando $\\ln$, temos\n",
                "$$\n",
                "-\\frac{nd}{2} \\ln(2\\pi) - \\frac{n}{2} \\ln\\lvert\\Sigma\\rvert - \\frac{n}{2} \\mathrm{tr}\\{\\Sigma^{-1}S^2(\\boldsymbol{x}_n^*)\\} =\n",
                "c - \\frac{n}{2}\\left( \\ln\\lvert\\Sigma\\rvert +  \\mathrm{tr}\\{\\Sigma^{-1}S^2(\\boldsymbol{x}_n^*)\\}\\right)\n",
                "$$\n",
                "\n",
                "Note que, para qualquer $\\lambda > 0$, temos\n",
                "$$\n",
                "\\lambda - \\ln\\lambda \\geq 1.\n",
                "$$\n",
                "\n",
                "Sejam $\\lambda_1, \\dots, \\lambda_d$ autovalores de uma matriz positiva definida $M$.\n",
                "$$\n",
                "\\begin{aligned}\n",
                "\\lambda_i &- \\ln \\lambda_i \\geq 1 \\forall i = 1, \\dots, d \\\\\n",
                "\\Rightarrow &\\sum^d \\lambda_i - \\sum^d \\ln_i \\geq d \\\\\n",
                "\\iff& \\sum^d \\lambda_i - \\ln(\\prod^d \\lambda_i) \\geq d \\\\\n",
                "\\Rightarrow &\\mathrm{tr}\\{M\\} - \\ln\\lvert M\\rvert \\geq d\n",
                "\\end{aligned}\n",
                "$$\n",
                "Tome $M = \\Sigma^{-1} S^(\\boldsymbol{x}_n^*)$. Então, assumindo $S^2(\\boldsymbol{x}_n^*)$ positiva definida, $M$ é positiva\n",
                "definida e\n",
                "$$\n",
                "\\begin{aligned}\n",
                "&\\mathrm{tr}\\{\\Sigma^{-1}S^2(\\boldsymbol{x}_n^*)\\} - \\ln\\lvert\\Sigma^{-1}S^2(\\boldsymbol{x}_n^*)\\rvert \\geq d \\\\\n",
                "\\iff&\\mathrm{tr}\\{\\Sigma^{-1}S^2(\\boldsymbol{x}_n^*)\\} - \\ln(\\lvert\\Sigma^{-1}\\rvert \\lvert S^2(\\boldsymbol{x}_n^*)\\rvert) \\geq d \\\\\n",
                "\\iff&\\mathrm{tr}\\{\\Sigma^{-1}S^2(\\boldsymbol{x}_n^*)\\} + \\ln\\lvert\\Sigma\\rvert - \\ln \\lvert S^2(\\boldsymbol{x}_n^*)\\rvert \\geq d \\\\\n",
                "\\iff&\\mathrm{tr}\\{\\Sigma^{-1}S^2(\\boldsymbol{x}_n^*)\\} + \\ln\\lvert\\Sigma\\rvert \\geq d + \\ln \\lvert S^2(\\boldsymbol{x}_n^*)\\rvert\n",
                "\\end{aligned}\n",
                "$$\n",
                "\n",
                "Note que a igualdade (o menor valor possível) é atingida quando $\\Sigma = S^2(\\boldsymbol{x}_n^*)$ pois\n",
                "$$\n",
                "\\mathrm{tr}\\{S^2(\\boldsymbol{x}_n^*)^{-1}S^2(\\boldsymbol{x}_n^*)\\} = \\mathrm{tr}\\{I_d\\} = d\n",
                "$$\n",
                "Logo,\n",
                "$$\n",
                "\\begin{aligned}\n",
                "\\hat{\\mu}_{\\mathrm{MV}}(\\boldsymbol{X}^*_n) &= \\bar{\\boldsymbol{X}} = \\frac{1}{n} \\sum^n_{i=1} \\boldsymbol{X}_i \\\\\n",
                "\\hat{\\Sigma}_{\\mathrm{MV}}(\\boldsymbol{X}^*_n) &= S^2(\\boldsymbol{X}_n^*) = \\frac{1}{n} \\sum^n_{i=1} (\\boldsymbol{X}_i - \\bar{\\boldsymbol{X}})(\\boldsymbol{X}_i - \\bar{\\boldsymbol{X}})^T\n",
                "\\end{aligned}\n",
                "$$\n",
                "são os [estimadores de máxima verossimilhança](emv2.qmd) para $\\mu$ e $\\Sigma$, respectivamente. Dessa forma, podemos estimar\n",
                "usando a [propriedade de invariância](prop-est.qmd#sec-invaremv) qualquer [quantidade de interesse](quantidade-de-interesse.qmd)\n",
                "$g(\\theta)$\n",
                "\n",
                "### Exemplo\n",
                "\n",
                "Seja $\\boldsymbol{X}_n^*$ a.a. de $\\boldsymbol{X} \\sim N_2(\\boldsymbol{\\mu}, \\Sigma)$. Encontre o EMV para $g(\\theta)$, em que\n",
                "\n",
                "1. $g(\\theta) = E_\\theta(\\boldsymbol{X})$\n",
                "\n",
                "2. $g(\\theta) = \\mathrm{Var}_\\theta(\\boldsymbol{X})$\n",
                "\n",
                "3. $g(\\theta) = E_\\theta(\\boldsymbol{X})^T \\mathrm{Var}_\\theta(\\boldsymbol{X})^{-1}E_\\theta(\\boldsymbol{X})$\n",
                "\n",
                "4. $g(\\theta) = P_\\theta(X_1 \\geq 4 X_2), \\boldsymbol{X} = (X_1, X_2)^T$\n",
                "\n",
                "5. Considerando os dados observados abaixo, apresente as estimativas para $g(\\theta)$ dos itens anteriores:\n",
                "\n",
                "#### Resposta\n",
                "\n",
                "Já sabemos que os estimadores são dados por\n",
                "$$\n",
                "\\begin{aligned}\n",
                "\\hat{\\mu}_{\\mathrm{MV}}(\\boldsymbol{X}^*_n) &= \\bar{\\boldsymbol{X}} = \\frac{1}{n} \\sum^n_{i=1} \\boldsymbol{X}_i \\\\\n",
                "\\hat{\\Sigma}_{\\mathrm{MV}}(\\boldsymbol{X}^*_n) &= S^2(\\boldsymbol{X}_n^*) = \\frac{1}{n} \\sum^n_{i=1}\n",
                "(\\boldsymbol{X}_i - \\bar{\\boldsymbol{X}})(\\boldsymbol{X}_i - \\bar{\\boldsymbol{X}})^T \\\\\n",
                "&= \\frac{1}{n} \\sum \\boldsymbol{X}_i\\boldsymbol{X}^T - \\bar{\\boldsymbol{X}}\\bar{\\boldsymbol{X}}^T\n",
                "\\end{aligned}\n",
                "$$\n",
                "e as estimativas por\n",
                "$$\n",
                "\\begin{aligned}\n",
                "\\hat{\\mu}_{\\mathrm{MV}}(\\boldsymbol{x}^*_n) &= \\bar{\\boldsymbol{x}} = \\frac{1}{n} \\sum^n_{i=1} \\boldsymbol{x}_i\n",
                "= \\frac{1}{n}\\begin{pmatrix}\n",
                "\\sum x_{1i} \\\\\n",
                "\\sum x_{2i}\n",
                "\\end{pmatrix}\\\\\n",
                "\\hat{\\Sigma}_{\\mathrm{MV}}(\\boldsymbol{x}^*_n) &= S^2(\\boldsymbol{x}_n^*) = \\frac{1}{n} \\sum \\boldsymbol{x}_i\\boldsymbol{x}^T - \\bar{\\boldsymbol{x}}\\bar{\\boldsymbol{x}}^T\\\\\n",
                "&=\\frac{1}{n} \\sum^n_{i=1}\\begin{bmatrix}\n",
                "(x_{1i} - \\bar{x}_1)^2 & (x_{1i} - \\bar{x}_1)(x_{2i} - \\bar{x}_2) \\\\\n",
                "(x_{2i} - \\bar{x}_2)(x_{1i} - \\bar{x}_1) & (x_{2i} - \\bar{x}_2)^2\n",
                "\\end{bmatrix}\n",
                "\\end{aligned}\n",
                "$$\n",
                "\n",
                "<!-- TODO: 1:3 só faz substituindo valores e pronto -->\n",
                "\n",
                "4. $P_\\theta(X2 > 4X_1) = P_\\theta(X_2 - 4X_1 > 0)$. Note que\n",
                "$$\n",
                "X_2 - 4X_1 = B \\boldsymbol{X}\n",
                "$$\n",
                "em que $B = (-4, 1)$. Então,\n",
                "$$\n",
                "X_2 - 4X_1 \\sim N(B\\boldsymbol{\\mu}, B\\Sigma B^T)\n",
                "$$\n",
                "Desenvolvendo,\n",
                "$$\n",
                "\\begin{aligned}\n",
                "B\\boldsymbol{\\mu} &= -4\\mu_1 + \\mu_2 = \\mu_2 - 4\\mu_1 \\\\\n",
                "B\\Sigma B^T &= (-4,1) \\begin{bmatrix}\\sigma_{11} & \\sigma_{12} \\\\ \\sigma_{21} & \\sigma_{22} \\end{bmatrix} \\begin{pmatrix}-4 \\\\ 1 \\end{pmatrix} \\\\\n",
                "&\\stackrel{\\sigma_{12} = \\sigma_{21}}{=} 16\\sigma_{11} + \\sigma_{22} - 8 \\sigma_{12}\n",
                "\\end{aligned}\n",
                "$$\n",
                "\n",
                "Assim,\n",
                "$$\n",
                "\\begin{aligned}\n",
                "g(\\theta) &= P_\\theta(X_2 - 4 X_1 > 0) \\\\\n",
                "&= P_\\theta\\left(\\frac{(X_2 - 4X_1) - (\\mu_2 -4\\mu_1)}{\\sqrt{16\\sigma_{11} + \\sigma_{22} - 8 \\sigma_{12}}} >\n",
                "-\\frac{\\mu_2 -4\\mu_1}{\\sqrt{16\\sigma_{11} + \\sigma_{22} - 8 \\sigma_{12}}}\\right) \\\\\n",
                "&= P\\left( Z > -\\frac{\\mu_2 -4\\mu_1}{\\sqrt{16\\sigma_{11} + \\sigma_{22} - 8 \\sigma_{12}}}\\right) \\\\\n",
                "&= 1 - \\Phi\\left(-\\frac{\\mu_2 -4\\mu_1}{\\sqrt{16\\sigma_{11} + \\sigma_{22} - 8 \\sigma_{12}}}\\right)\n",
                "\\end{aligned} \\\\\n",
                "$$\n",
                "\n",
                "<!-- TODO: concluir com valores -->"
            ]
        }
    ],
    "timestamp": "2025-05-17T11:05:03.959",
    "file": "/home/minze/usp/patriota/anotacoes-inferencia/normal-multivariada.qmd",
    "qnr_schema_version": "1.0.0"
}